<!DOCTYPE html>
<!-- saved from url=(0059)http://www.expressjs.com.cn/guide/database-integration.html -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Express 集成数据库</title>
      
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      
      <link rel="stylesheet" href="./14Express 集成数据库_files/style.css">
      <link rel="stylesheet" href="./14Express 集成数据库_files/dropit.css">
      <link rel="stylesheet" href="./14Express 集成数据库_files/prism.css">
      <link href="./14Express 集成数据库_files/font-awesome.min.css" rel="stylesheet">
      <link rel="stylesheet" href="./14Express 集成数据库_files/css">
  
      <script src="./14Express 集成数据库_files/hm.js.下载"></script><script src="./14Express 集成数据库_files/hm.js(1).下载"></script><script data-cfasync="false" src="./14Express 集成数据库_files/jquery.min.js.下载"></script>
      <script data-cfasync="false" src="./14Express 集成数据库_files/app.js.下载"></script>
      <script data-cfasync="false" src="./14Express 集成数据库_files/retina.js.下载"></script>
      <script data-cfasync="false" src="./14Express 集成数据库_files/dropit.js.下载"></script>
      <script data-cfasync="false" src="./14Express 集成数据库_files/prism.js.下载"></script>
      <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?1e9527683dc35951cb595bc55ece8e84";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
      </script></head>

  <body rlt="1" class="scroll">

    <section class="content">

      <header>
        <div id="mobile-menu">
            <div id="nav-button" class="fa fa-bars fa-2x button"></div>
        </div>
        <section id="logo"><a href="http://www.expressjs.com.cn/" class="express">Express</a>
        </section>
        <div id="navbar">
            <ul id="navmenu">
                <li><a href="http://www.expressjs.com.cn/" id="home-menu">首页</a></li>
                <li>
                    <ul id="getting-started-menu" class="menu dropit">
                        <li class="dropit-trigger"><a href="http://www.expressjs.com.cn/starter/installing.html">入门</a>
                            <ul class="dropit-submenu" style="display: none;">
                                <li>
                                  <a href="http://www.expressjs.com.cn/starter/installing.html">
                                    安装
                                  </a>
                                </li>
                                <li>
                                  <a href="http://www.expressjs.com.cn/starter/hello-world.html">
                                    Hello world
                                  </a>
                                </li>
                                <li>
                                <a href="http://www.expressjs.com.cn/starter/generator.html">
                                  Express 应用生成器
                                </a>
                                </li>
                                <li>
                                  <a href="http://www.expressjs.com.cn/starter/basic-routing.html">
                                    基本路由
                                  </a>
                                </li>
                                <li>
                                  <a href="http://www.expressjs.com.cn/starter/static-files.html">
                                    静态文件
                                  </a>
                                </li>
                                <li>
                                  <a href="http://www.expressjs.com.cn/starter/faq.html">
                                    常见问题
                                  </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <ul id="guide-menu" class="menu dropit">
                        <li class="dropit-trigger"><a href="http://www.expressjs.com.cn/guide/routing.html">使用指南</a>
                            <ul class="dropit-submenu" style="display: none;">
                                <li><a href="http://www.expressjs.com.cn/guide/routing.html">路由</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/guide/using-middleware.html">中间件</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/guide/using-template-engines.html">模板引擎</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/guide/error-handling.html">错误处理</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/guide/debugging.html">调试</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/guide/behind-proxies.html">为 Express 设置代理</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/guide/migrating-4.html">升级到 Express 4</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/guide/database-integration.html">数据库集成</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <ul id="application-menu" class="menu dropit">
                        <li class="dropit-trigger"><a href="http://www.expressjs.com.cn/4x/api.html">API 中文手册</a>
                            <ul class="dropit-submenu" style="display: none;">
                                <li><a href="http://www.expressjs.com.cn/4x/api.html">4.x 版本</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/3x/api.html">3.x 版本</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <ul id="advanced-topics-menu" class="menu dropit">
                        <li class="dropit-trigger"><a href="http://www.expressjs.com.cn/advanced/developing-template-engines.html">进阶话题</a>
                            <ul class="dropit-submenu" style="display: none;">
                                <li><a href="http://www.expressjs.com.cn/advanced/developing-template-engines.html">模板引擎</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/advanced/pm.html">进程管理器</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/advanced/security-updates.html">安全更新</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <ul id="resources-menu" class="menu dropit">
                        <li class="dropit-trigger"><a href="http://www.expressjs.com.cn/resources/glossary.html">有用的资源</a>
                            <ul class="dropit-submenu" style="display: none;">
                                <li><a href="http://www.expressjs.com.cn/resources/glossary.html">术语表</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/resources/middleware.html">中间件</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/resources/community.html">社区</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/resources/books-blogs.html">书籍与博客</a>
                                </li>
                                <li><a href="http://www.expressjs.com.cn/resources/applications.html">实例展示</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
      </header>
      <div id="overlay"></div>
    
      
<h1 id="section">集成数据库</h1>

<p>为 Express 应用添加连接数据库的能力，只需要加载相应数据库的 Node.js 驱动即可。这里将会简要介绍如何为 Express 应用添加和使用一些常用的数据库 Node 模块。</p>

<ul>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#cassandra">Cassandra</a></li>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#couchdb">CouchDB</a></li>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#leveldb">LevelDB</a></li>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#mysql">MySQL</a></li>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#mongo">MongoDB</a></li>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#neo4j">Neo4j</a></li>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#postgres">PostgreSQL</a></li>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#redis">Redis</a></li>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#sqlite">SQLite</a></li>
  <li><a href="http://www.expressjs.com.cn/guide/database-integration.html#elasticsearch">ElasticSearch</a></li>
</ul>

<div class="doc-box doc-notice">
  <p>这些数据库驱动只是其中一部分，可在 <a href="https://www.npmjs.com/">npm 官网</a> 查找更多驱动。</p>
</div>

<p><a name="cassandra"></a></p>

<h2 id="cassandra">Cassandra</h2>

<p><strong>模块</strong>: <a href="https://github.com/datastax/nodejs-driver">cassandra-driver</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install cassandra-driver
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> cassandra <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'cassandra-driver'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">cassandra<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span><span class="token punctuation">{</span> contactPoints<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'localhost'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">execute<span class="token punctuation">(</span></span><span class="token string">'select key from system.local'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>result<span class="token punctuation">.</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

<p><a name="couchdb"></a></p>

<h2 id="couchdb">CouchDB</h2>

<p><strong>模块</strong>: <a href="https://github.com/dscape/nano">nano</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install nano
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> nano <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'nano'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'http://localhost:5984'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
nano<span class="token punctuation">.</span>db<span class="token punctuation">.</span><span class="token function">create<span class="token punctuation">(</span></span><span class="token string">'books'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> books <span class="token operator">=</span> nano<span class="token punctuation">.</span>db<span class="token punctuation">.</span><span class="token function">use<span class="token punctuation">(</span></span><span class="token string">'books'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//Insert a book document in the books database
</span>books<span class="token punctuation">.</span><span class="token function">insert<span class="token punctuation">(</span></span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'The Art of war'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//Get a list of all books
</span>books<span class="token punctuation">.</span><span class="token function">list<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> body<span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>body<span class="token punctuation">.</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>

<p><a name="leveldb"></a></p>

<h2 id="leveldb">LevelDB</h2>

<p><strong>模块</strong>: <a href="https://github.com/rvagg/node-levelup">levelup</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install level levelup leveldown
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> levelup <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'levelup'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">levelup<span class="token punctuation">(</span></span><span class="token string">'./mydb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token function">put<span class="token punctuation">(</span></span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'LevelUP'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'Ooops!'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  db<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'Ooops!'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'name='</span> <span class="token operator">+</span> value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

<p><a name="mysql"></a></p>

<h2 id="mysql">MySQL</h2>

<p><strong>模块</strong>: <a href="https://github.com/felixge/node-mysql/">mysql</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install mysql
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> mysql      <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'mysql'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> connection <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  host     <span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
  user     <span class="token punctuation">:</span> <span class="token string">'dbuser'</span><span class="token punctuation">,</span>
  password <span class="token punctuation">:</span> <span class="token string">'s3kreee7'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

connection<span class="token punctuation">.</span><span class="token function">connect<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

connection<span class="token punctuation">.</span><span class="token function">query<span class="token punctuation">(</span></span><span class="token string">'SELECT 1 + 1 AS solution'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> rows<span class="token punctuation">,</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'The solution is: '</span><span class="token punctuation">,</span> rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>solution<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

connection<span class="token punctuation">.</span><span class="token function">end<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

<p><a name="mongo"></a></p>

<h2 id="mongodb">MongoDB</h2>

<p><strong>模块</strong>: <a href="https://github.com/kissjs/node-mongoskin">mongoskin</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install mongoskin
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'mongoskin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">db<span class="token punctuation">(</span></span><span class="token string">'localhost:27017/animals'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token function">collection<span class="token punctuation">(</span></span><span class="token string">'mamals'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

<p>If you want a object model driver for MongoDB, checkout <a href="https://github.com/LearnBoost/mongoose">Mongoose</a>.</p>

<p><a name="neo4j"></a></p>

<h2 id="neo4j">Neo4j</h2>

<p><strong>模块</strong>: <a href="https://github.com/hacksparrow/apoc">apoc</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install apoc
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> apoc <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'apoc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

apoc<span class="token punctuation">.</span><span class="token function">query<span class="token punctuation">(</span></span><span class="token string">'match (n) return n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then<span class="token punctuation">(</span></span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span>fail<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>fail<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

<p><a name="postgres"></a></p>

<h2 id="postgresql">PostgreSQL</h2>

<p><strong>模块</strong>: <a href="https://github.com/brianc/node-postgres">pg</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install pg
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> pg <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'pg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> conString <span class="token operator">=</span> <span class="token string">"postgres://username:password@localhost/database"</span><span class="token punctuation">;</span>

pg<span class="token punctuation">.</span><span class="token function">connect<span class="token punctuation">(</span></span>conString<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> client<span class="token punctuation">,</span> done<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error<span class="token punctuation">(</span></span><span class="token string">'error fetching client from pool'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  client<span class="token punctuation">.</span><span class="token function">query<span class="token punctuation">(</span></span><span class="token string">'SELECT $1::int AS number'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">done<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error<span class="token punctuation">(</span></span><span class="token string">'error running query'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>result<span class="token punctuation">.</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

<p><a name="redis"></a></p>

<h2 id="redis">Redis</h2>

<p><strong>模块</strong>: <a href="https://github.com/mranney/node_redis">redis</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install redis
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'redis'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createClient<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">on<span class="token punctuation">(</span></span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'Error '</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'string key'</span><span class="token punctuation">,</span> <span class="token string">'string val'</span><span class="token punctuation">,</span> redis<span class="token punctuation">.</span>print<span class="token punctuation">)</span><span class="token punctuation">;</span>
client<span class="token punctuation">.</span><span class="token function">hset<span class="token punctuation">(</span></span><span class="token string">'hash key'</span><span class="token punctuation">,</span> <span class="token string">'hashtest 1'</span><span class="token punctuation">,</span> <span class="token string">'some value'</span><span class="token punctuation">,</span> redis<span class="token punctuation">.</span>print<span class="token punctuation">)</span><span class="token punctuation">;</span>
client<span class="token punctuation">.</span><span class="token function">hset<span class="token punctuation">(</span></span><span class="token punctuation">[</span><span class="token string">'hash key'</span><span class="token punctuation">,</span> <span class="token string">'hashtest 2'</span><span class="token punctuation">,</span> <span class="token string">'some other value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> redis<span class="token punctuation">.</span>print<span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">hkeys<span class="token punctuation">(</span></span><span class="token string">'hash key'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> replies<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>replies<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">' replies:'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  replies<span class="token punctuation">.</span><span class="token function">forEach<span class="token punctuation">(</span></span><span class="token keyword">function</span> <span class="token punctuation">(</span>reply<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span><span class="token string">'    '</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> reply<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  client<span class="token punctuation">.</span><span class="token function">quit<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

<p><a name="sqlite"></a></p>

<h2 id="sqlite">SQLite</h2>

<p><strong>模块</strong>: <a href="https://github.com/mapbox/node-sqlite3">sqlite3</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install sqlite3
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> sqlite3 <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'sqlite3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">verbose<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">sqlite3<span class="token punctuation">.</span>Database</span><span class="token punctuation">(</span><span class="token string">':memory:'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token function">serialize<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  db<span class="token punctuation">.</span><span class="token function">run<span class="token punctuation">(</span></span><span class="token string">'CREATE TABLE lorem (info TEXT)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> stmt <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">prepare<span class="token punctuation">(</span></span><span class="token string">'INSERT INTO lorem VALUES (?)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    stmt<span class="token punctuation">.</span><span class="token function">run<span class="token punctuation">(</span></span><span class="token string">'Ipsum '</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  stmt<span class="token punctuation">.</span><span class="token function">finalize<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  db<span class="token punctuation">.</span><span class="token function">each<span class="token punctuation">(</span></span><span class="token string">'SELECT rowid AS id, info FROM lorem'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> row<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log<span class="token punctuation">(</span></span>row<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> row<span class="token punctuation">.</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token function">close<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

<p><a name="elasticsearch"></a></p>

<h2 id="elasticsearch">ElasticSearch</h2>

<p><strong>模块</strong>: <a href="https://github.com/elastic/elasticsearch-js">elasticsearch</a><br>
<strong>安装</strong></p>

<pre class="language-sh"><code class="language-sh">$ npm install elasticsearch
</code></pre>

<p><strong>示例</strong></p>

<pre class="  language-javascript"><code class="  language-javascript"><span class="token keyword">var</span> elasticsearch <span class="token operator">=</span> <span class="token function">require<span class="token punctuation">(</span></span><span class="token string">'elasticsearch'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> client <span class="token operator">=</span> elasticsearch<span class="token punctuation">.</span><span class="token function">Client<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  host<span class="token punctuation">:</span> <span class="token string">'localhost:9200'</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">search<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  index<span class="token punctuation">:</span> <span class="token string">'books'</span><span class="token punctuation">,</span>
  type<span class="token punctuation">:</span> <span class="token string">'book'</span><span class="token punctuation">,</span>
  body<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    query<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      multi_match<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        query<span class="token punctuation">:</span> <span class="token string">'express js'</span><span class="token punctuation">,</span>
        fields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'description'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then<span class="token punctuation">(</span></span><span class="token keyword">function</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> hits <span class="token operator">=</span> response<span class="token punctuation">.</span>hits<span class="token punctuation">.</span>hits<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">trace<span class="token punctuation">(</span></span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>

      
    </section>

    <a id="top" href="http://www.expressjs.com.cn/guide/database-integration.html#"><img src="./14Express 集成数据库_files/arrow.png"></a>
    
    <footer>
        <div id="footer-content">
            <div id="github">
                <a href="https://github.com/strongloop/express" target="_blank">Github Repo</a>
            </div>
            <div id="sponsor">Express 项目由 <a href="http://strongloop.com/" target="_blank">StrongLoop</a> 赞助。</div>
            <div id="fork"><a href="https://github.com/strongloop/expressjs.com/blob/gh-pages/guide/database-integration.md">Edit this page on GitHub</a></div>
            <div>Copyright © StrongLoop, Inc., and other expressjs.com contributors.</div>
        </div>
    
        <div class="friend-links">
            <a href="http://www.bootcss.com/" title="Bootstrap 中文网">Bootstrap中文网</a>
            <a href="http://www.gruntjs.net/" title="Grunt 中文网">Grunt中文网</a>
            <a href="http://www.gulpjs.com.cn/" title="Gulp 中文网">Gulp中文网</a>
            <a href="http://www.bootcdn.cn/" title="BootCDN 加速">BootCDN</a>
            <a href="http://www.nodeapp.cn/" title="Node.js 中文文档">Node.js 中文文档</a>
        </div>
    </footer>
    
    <div class="beian">
    	<a href="http://www.miibeian.gov.cn/" target="_blank">冀ICP备15008021号</a><span>|</span>© Express 中文网 2015
    </div>
  


</body></html>